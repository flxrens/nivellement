<!DOCTYPE html>
<html lang="de">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Nivellement</title>
<link rel="apple-touch-icon" href="icon.png">

<style>
body {
    font-family: -apple-system, sans-serif;
    background: #0f172a;
    color: white;
    padding: 25px;
    text-align: center;
}
input, button {
    padding: 12px;
    margin: 8px;
    font-size: 17px;
    border-radius: 10px;
    border: none;
}
input {
    width: 90%;
    max-width: 300px;
    text-align: center;
}
button {
    background: #38bdf8;
}
.box {
    background: #1e293b;
    padding: 20px;
    border-radius: 15px;
    transition: background 0.3s;
}
.result {
    font-size: 20px;
    margin-top: 10px;
}
.dim {
    opacity: 0.4;
}
.bg-black { background: #000000; }
.bg-green { background: #166534; }
.bg-blue  { background: #1e40af; }
.bg-red   { background: #7f1d1d; }
</style>
</head>

<body>

<h2>Nivellement</h2>

<div class="box" id="mainBox">

<p><b>Δh Hin (m)</b></p>
<input id="dh_hin" type="text" inputmode="decimal" pattern="-?[0-9]*[.,]?[0-9]*">

<p><b>Δh Rück (m)</b></p>
<input id="dh_rueck" type="text" inputmode="decimal" pattern="-?[0-9]*[.,]?[0-9]*">

<p><b>s Hin (km)</b></p>
<input id="s_hin" type="text" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*">

<p><b>s Rück (km)</b></p>
<input id="s_rueck" type="text" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*">

<br>
<button onclick="rechne()">Prüfen</button>

<div class="result" id="w">W: —</div>
<div class="result" id="z">Z (LSA): —</div>
<div class="result" id="z_adv">Z (AdV): —</div>

</div>

<script>
function parseNum(id) {
    let v = document.getElementById(id).value.trim();
    if (v === "") return NaN;
    return parseFloat(v.replace(",", "."));
}

function rechne() {

    let T4 = parseNum("dh_hin");
    let T5 = parseNum("dh_rueck");
    let S4 = parseNum("s_hin");
    let S5 = parseNum("s_rueck");

    let W = "", Z = "", Z_ADV = "";

    // ===== W =====
    if (!isNaN(T4) && !isNaN(T5)) {
        W = Math.round(((T4 + T5) * 1000) * 100) / 100;
    }

    // ===== Z und Z(AdV) =====
    if (!isNaN(S4) && !isNaN(S5) && W !== "") {
        let sign = (W === 0) ? 1 : Math.sign(W);
        let avg = (S4 + S5) / 2;
        Z = Math.round((sign * 1.6 * Math.sqrt(avg)) * 100) / 100;
        Z_ADV = Math.round((0.5 * avg + sign * 1.5 * Math.sqrt(avg)) * 100) / 100;
    }

    // ===== Anzeige & Dimmen =====
    let zBox = document.getElementById("z");
    let zAdvBox = document.getElementById("z_adv");
    let box = document.getElementById("mainBox");

    zBox.classList.remove("dim");
    zAdvBox.classList.remove("dim");
    box.className = "box";

    let ratio = null;

    if (W > 0) {
        zAdvBox.classList.add("dim");
        ratio = W / Z;
    } else if (W < 0) {
        zBox.classList.add("dim");
        ratio = W / Z_ADV;
    }

    // ===== Farblogik =====
    if (ratio !== null && !isNaN(ratio)) {
        if (ratio < 0.34) box.classList.add("bg-black");
        else if (ratio < 0.666) box.classList.add("bg-green");
        else if (ratio < 1) box.classList.add("bg-blue");
        else box.classList.add("bg-red");
    }

    // ===== Anzeige =====
    document.getElementById("w").innerText =
        "W: " + (W === "" ? "—" : W.toFixed(2));

    zBox.innerText =
        "Z (LSA): " + (Z === "" ? "—" : Z.toFixed(2));

    zAdvBox.innerText =
        "Z (AdV): " + (Z_ADV === "" ? "—" : Z_ADV.toFixed(2));
}
</script>

</body>
</html>